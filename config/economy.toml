# EC4X Economy Configuration
# Core economic mechanics: population, production, investment, taxation, colonization
#
# This file contains:
# - BALANCE VARIABLES: Tunable gameplay parameters (adjust during playtesting)
# - CORE MECHANICS: Fundamental game rules (mathematical formulas, type systems)
#
# Note: Starting resources and scenario setup are in game_setup/*.toml files
# Note: Construction costs/times are in construction.toml
# Note: Military squadron limits are in military.toml

# ============================================================================
# POPULATION MECHANICS
# ============================================================================

[population]
# BALANCE VARIABLES - Tunable growth rates
# ACCELERATION: Increased for 30-turn multi-generational timeline
natural_growth_rate = 0.05         # 5% natural birth rate per turn (was 2%)
growth_rate_per_starbase = 0.10    # +10% per starbase (was 5%, max 3 starbases)
max_starbase_bonus = 0.30          # Maximum 30% bonus (was 15%, 3 starbases)
ptu_growth_rate = 0.04             # 4% per turn under normal conditions (was 1.5%)

# GAME CONSTANTS - Mathematical formulas
ptu_to_souls = 50000               # One PTU is approximately 50k souls (scale constant)
pu_to_ptu_conversion = 0.00657     # PU to PTU conversion constant (exponential formula)

# ============================================================================
# PRODUCTION MECHANICS
# ============================================================================

[production]
# BALANCE VARIABLES - Production distribution
# ACCELERATION: 2.5x increase for 30-45 turn game pacing
production_per_10_population = 5   # Was 2 → 2.5x increase (5 production per 10 million population)
production_split_credits = 0.33    # 1/3 of production → credits
production_split_production = 0.33 # 1/3 of production → industrial units
production_split_research = 0.33   # 1/3 of production → research points

[infrastructure]
# Infrastructure bonuses
# TODO: Define infrastructure production modifiers

# ============================================================================
# PLANET TYPE SYSTEM (GAME CONSTANTS)
# These define the seven planet classes and their population limits
# ============================================================================

[planet_classes]
# Population Unit (PU) limits by planet class
extreme_pu_min = 1
extreme_pu_max = 20

desolate_pu_min = 21
desolate_pu_max = 60

hostile_pu_min = 61
hostile_pu_max = 180

harsh_pu_min = 181
harsh_pu_max = 500

benign_pu_min = 501
benign_pu_max = 1000

lush_pu_min = 1001
lush_pu_max = 2000

eden_pu_min = 2001
# eden has no max

# ============================================================================
# RESEARCH MECHANICS
# ============================================================================

[research]
# Technology research costs
# Cost formula: base * (level ^ exponent)
research_cost_base = 1000          # Base cost for level 1
research_cost_exponent = 2         # Quadratic scaling (level^2)

# Tech fields: EconomicLevel, ShieldLevel, ConstructionTech, WeaponsTech,
#              TerraformingTech, ElectronicIntelligence, CounterIntelligence
#              (all hardcoded in engine)

# Research breakthrough mechanics (occurs every 6 turns)
research_breakthrough_base_chance = 0.10  # 10% base chance for breakthrough
research_breakthrough_rp_per_percent = 50  # +1% bonus per 50 RP invested
minor_breakthrough_bonus = 10      # +10 ERP/SRP/TRP for minor breakthrough
moderate_breakthrough_discount = 0.20  # 20% reduction in next TRP cost
revolutionary_quantum_computing_el_mod_bonus = 0.10  # +10% to EL_MOD
revolutionary_stealth_detection_bonus = 2  # +2 detection difficulty for Raiders
revolutionary_terraforming_growth_bonus = 0.02  # +2% colony growth per turn

# ERP (Economic Research Points) cost formula: 1 ERP = (5 + log(GHO)) PP
erp_base_cost = 5                  # Base cost component for ERP

# EL (Economic Level) progression costs
el_early_base = 40                 # EL1-5: ERP = 40 + EL(10)
el_early_increment = 10            # EL increment for levels 1-5
el_late_increment = 15             # EL6+: increases by 15 points per level

# SRP (Science Research Points) cost formula: 1 SRP = 2 + SL(0.5) PP
srp_base_cost = 2                  # Base cost component for SRP
srp_sl_multiplier = 0.5            # SL multiplier for SRP cost

# SL (Science Level) progression costs
sl_early_base = 20                 # SL1-5: SRP = 20 + SL(5)
sl_early_increment = 5             # SL increment for levels 1-5
sl_late_increment = 10             # SL6+: increases by 10 per level

# TRP (Technology Research Points) cost formula: 1 TRP = (5 + 4(SL))/10 + log(GHO) * 0.5 PP
trp_first_level_cost = 25          # Starting cost for first tech level
trp_level_increment = 5            # Each level costs +5 TRP more

# ============================================================================
# ESPIONAGE COSTS
# ============================================================================

[espionage]
# Espionage and Counter-Intelligence costs
ebp_cost_per_point = 40            # PP cost per Espionage Budget Point (EBP)
cip_cost_per_point = 40            # PP cost per Counter Intelligence Point (CIP)
max_actions_per_turn = 1           # Maximum espionage actions per turn

# Over-investment penalties (prestige loss)
budget_threshold_percent = 5       # Above this % of budget loses prestige
prestige_loss_per_percent_over = 1 # Prestige lost per 1% over threshold

# Espionage action costs (in EBP)
tech_theft_cost = 5
sabotage_low_cost = 2
sabotage_high_cost = 7
assassination_cost = 10
cyber_attack_cost = 6
economic_manipulation_cost = 6
psyops_campaign_cost = 3

# Counter-intelligence detection cost
detection_roll_cost = 1            # CIP cost per detection attempt

# ============================================================================
# RAW Material Efficiency Table
# Source: docs/specs/economy.md Section 3.1
# ============================================================================

[raw_material_efficiency]
# RAW INDEX by planet class (percentages as decimals)
# Format: raw_quality_planetclass = efficiency

# Very Poor
very_poor_eden = 0.60
very_poor_lush = 0.60
very_poor_benign = 0.60
very_poor_harsh = 0.60
very_poor_hostile = 0.60
very_poor_desolate = 0.60
very_poor_extreme = 0.60

# Poor
poor_eden = 0.80
poor_lush = 0.75
poor_benign = 0.70
poor_harsh = 0.65
poor_hostile = 0.64
poor_desolate = 0.63
poor_extreme = 0.62

# Abundant
abundant_eden = 1.00
abundant_lush = 0.90
abundant_benign = 0.80
abundant_harsh = 0.70
abundant_hostile = 0.68
abundant_desolate = 0.66
abundant_extreme = 0.64

# Rich
rich_eden = 1.20
rich_lush = 1.05
rich_benign = 0.90
rich_harsh = 0.75
rich_hostile = 0.72
rich_desolate = 0.69
rich_extreme = 0.66

# Very Rich
very_rich_eden = 1.40
very_rich_lush = 1.20
very_rich_benign = 1.00
very_rich_harsh = 0.80
very_rich_hostile = 0.76
very_rich_desolate = 0.72
very_rich_extreme = 0.68

# ============================================================================
# Tax System Mechanics
# Source: docs/specs/economy.md Section 3.2
# ============================================================================

[tax_mechanics]
tax_averaging_window_turns = 6     # Rolling 6-turn window for tax penalties

# ============================================================================
# Tax Rate - Population Growth Bonuses
# Source: docs/specs/economy.md Section 3.2.2
# Note: Prestige bonuses are in prestige.toml [tax_incentives]
# ============================================================================

[tax_population_growth]
# Low-tax population growth multipliers (applied same turn)
# Format: min_rate, max_rate, population_growth_multiplier
tier_1_min = 41
tier_1_max = 50
tier_1_pop_multiplier = 1.0

tier_2_min = 31
tier_2_max = 40
tier_2_pop_multiplier = 1.05

tier_3_min = 21
tier_3_max = 30
tier_3_pop_multiplier = 1.10

tier_4_min = 11
tier_4_max = 20
tier_4_pop_multiplier = 1.15

tier_5_min = 0
tier_5_max = 10
tier_5_pop_multiplier = 1.20

# ============================================================================
# Industrial Unit Investment Costs
# Source: docs/specs/economy.md Section 3.4
# ============================================================================

[industrial_investment]
# IU investment cost multipliers by percentage of PU
# BALANCE: 40% reduction to encourage faster IU development (5 → 3)
# With passive IU growth added, manual investment accelerates development
# Base cost is 3 PP per IU (was 5, originally 15, base 30)
# Payback: 3 turns at EL3 (1 IU produces ~1 PP/turn)
base_cost = 3

tier_1_max_percent = 50
tier_1_multiplier = 1.0
tier_1_pp = 3  # Was 5 → 40% reduction (base_cost * 1.0)

tier_2_min_percent = 51
tier_2_max_percent = 75
tier_2_multiplier = 1.2
tier_2_pp = 4  # Was 6 → 40% reduction (base_cost * 1.2, rounded)

tier_3_min_percent = 76
tier_3_max_percent = 100
tier_3_multiplier = 1.5
tier_3_pp = 5  # Was 8 → 40% reduction (base_cost * 1.5, rounded)

tier_4_min_percent = 101
tier_4_max_percent = 150
tier_4_multiplier = 2.0
tier_4_pp = 6  # Was 10 → 40% reduction (base_cost * 2.0)

tier_5_min_percent = 151
tier_5_multiplier = 2.5
tier_5_pp = 8  # Was 13 → 40% reduction (base_cost * 2.5, rounded)

# ============================================================================
# Colonization Costs
# Source: docs/specs/economy.md Section 3.7
# ============================================================================

[colonization]
# New colony starting values
starting_infrastructure_level = 1  # Infrastructure level (0-10 scale)
starting_iu_percent = 50  # 50% of PU converted to starting IU

# Homeworlds start with 50% of PU as IU (840 PU → 420 IU)
# New colonies follow same pattern: 3 PU × 0.5 = 1.5 IU (rounds to 1-2)

# PP per PTU by planet class
eden_pp_per_ptu = 4
lush_pp_per_ptu = 5
benign_pp_per_ptu = 6
harsh_pp_per_ptu = 8
hostile_pp_per_ptu = 10
desolate_pp_per_ptu = 12
extreme_pp_per_ptu = 15

# ============================================================================
# INDUSTRIAL GROWTH MECHANICS
# Source: engine refactoring - previously hardcoded values
# ============================================================================

[industrial_growth]
# IU passive growth formula: max(min_growth, floor(PU / divisor))
# RESOLVED: Use 100.0 for 2x rate (30-turn accelerated games)
# Previous conflict: income.nim used 100.0, industrial_investment.nim used 200.0
passive_growth_divisor = 100.0     # Divisor for PU to IU conversion
passive_growth_minimum = 2.0       # Minimum 2 IU growth per turn
applies_modifiers = true            # Apply tax + starbase bonuses

# ============================================================================
# STARBASE BONUSES
# Source: Previously hardcoded in gamestate.nim and production.nim
# ============================================================================

[starbase_bonuses]
growth_bonus_per_starbase = 0.05   # 5% population growth per starbase
max_starbases_for_bonus = 3        # Max 3 starbases (15% max bonus)
eli_bonus_per_starbase = 2         # ELI+2 per operational starbase

# ============================================================================
# SQUADRON CAPACITY
# Source: Previously in capital_squadrons.nim
# ============================================================================

[squadron_capacity]
# Capital squadron formula: max(minimum, floor(Total_IU / divisor) * multiplier)
capital_squadron_iu_divisor = 100   # IU divisor for capacity calculation
capital_squadron_multiplier = 2     # Multiplier after division
capital_squadron_minimum = 8        # Minimum capacity regardless of IU

# ============================================================================
# PRODUCTION MODIFIERS
# Source: Previously hardcoded in production.nim
# ============================================================================

[production_modifiers]
el_bonus_per_level = 0.05          # 5% per EL (Economic Level)
cst_bonus_per_level = 0.10         # 10% per CST (Construction Tech)
blockade_penalty = 0.40            # 40% production when blockaded
prod_growth_numerator = 50.0       # (50 - taxRate) / 500 formula
prod_growth_denominator = 500.0
