// EC4X Combat Rules Configuration v0.2
// Source: docs/specs/07-combat.md
// This file defines core combat mechanics.

// --- General Combat Rules ---
combat {
    (docs)"docs/specs/07-combat.md#section-7-3"
    criticalHitRoll 9       // Natural 9 on 1d10 is a critical hit
    retreatAfterRound 1     // Fleets can retreat after round 1
    maxCombatRounds 20      // Prevents infinite combat
    desperationRoundTrigger 5 // Stalemate for 5 rounds triggers +2 CER bonus
}

// --- Combat Effectiveness Rating (CER) ---
cer {
    (docs)"docs/specs/07-combat.md#section-7-3-3"

    modifiers {
        (docs)"docs/specs/07-combat.md#section-7-2-4"
        ambushBonus 4 // +4 for undetected Raider first-strike (replaces surprise/ambush)
        // Morale modifiers are handled in-game based on prestige
    }

    spaceCombatTable {
        // Inherits parent (docs) attribute
        tier 1 { maxRoll=2 multiplier=0.25 } // "Less than zero, 0, 1, 2"
        tier 2 { maxRoll=4 multiplier=0.50 } // "3, 4"
        tier 3 { maxRoll=6 multiplier=0.75 } // "5, 6"
        tier 4 { minRoll=7 multiplier=1.00 } // "7, 8, 9+"
    }

    bombardmentTable {
        (docs)"docs/specs/07-combat.md#section-7-5-1"
        tier 1 { maxRoll=2 multiplier=0.25 }
        tier 2 { maxRoll=5 multiplier=0.50 }
        tier 3 { maxRoll=8 multiplier=1.00 }
        // Natural 9 is a critical hit
    }

    groundCombatTable {
        (docs)"docs/specs/07-combat.md#section-7-6-1"
        tier 1 { maxRoll=2 multiplier=0.50 }
        tier 2 { maxRoll=6 multiplier=1.00 }
        tier 3 { maxRoll=8 multiplier=1.50 }
        tier 4 { roll=9 multiplier=2.00 } // Critical hit
    }
}

// --- Combat Damage & Targeting ---
damage {
    (docs)"docs/specs/07-combat.md#section-7-2-2"
    crippledAsMultiplier 0.5        // Crippled ship AS is halved
    crippledMaintenanceMultiplier 0.5 // Crippled ships have 50% maintenance cost
    crippledTargetingWeight 2.0     // Crippled squadrons have 2x targeting weight
}

retreat {
    (docs)"docs/specs/07-combat.md#section-7-3-6"
    fightersNeverRetreat true
    spaceliftDestroyedIfEscortLost true
    retreatToNearestFriendly true
}

// --- Blockade Mechanics ---
blockade {
    (docs)"docs/specs/06-operations.md#section-6-3-8"
    // Also see: docs/specs/10-reference.md#section-10-4
    gcoReduction 0.60        // -60% Gross Colonial Output (GCO)
    prestigePenaltyPerTurn 2 // -2 prestige per turn per blockaded colony
}

// --- Invasion Mechanics ---
invasion {
    (docs)"docs/specs/07-combat.md#section-7-6"
    iuLossOnConquest 0.50      // Conquered planet loses 50% of IU
    iuLossOnBlitz 0.00         // Blitz preserves all IU if successful
    blitzMarinePenalty 0.5   // Marines fight at 0.5x AS during a Blitz
}

// planetaryShields: Shield mechanics are now defined by SLD tech in config/tech.kdl and Section 7.5.2.
