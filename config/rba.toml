# EC4X Rule-Based AI Configuration
# All RBA tuning parameters centralized for balance testing
#
# This configuration system enables:
# - Balance testing without recompilation
# - Genetic algorithm parameter evolution
# - A/B testing of different AI behaviors
# - Rapid iteration during AI development
#
# IMPORTANT: All field names use snake_case to match engine config convention
# TOML structure mirrors the Nim type definitions in src/ai/rba/config.nim

# ==============================================================================
# STRATEGY PERSONALITIES (12 strategies × 6 traits)
# ==============================================================================
# Each strategy defines a unique AI personality with weighted preferences
# Traits range from 0.0 (minimum) to 1.0 (maximum)

[strategies_aggressive]
aggression = 0.9
risk_tolerance = 0.8
economic_focus = 0.5
expansion_drive = 0.8
diplomacy_value = 0.2
tech_priority = 0.4

[strategies_economic]
aggression = 0.3
risk_tolerance = 0.3
economic_focus = 0.9
expansion_drive = 0.5
diplomacy_value = 0.6
tech_priority = 0.8

[strategies_espionage]
aggression = 0.5
risk_tolerance = 0.6
economic_focus = 0.5
expansion_drive = 0.65
diplomacy_value = 0.4
tech_priority = 0.6

[strategies_diplomatic]
aggression = 0.3
risk_tolerance = 0.4
economic_focus = 0.6
expansion_drive = 0.5
diplomacy_value = 0.9
tech_priority = 0.5

[strategies_balanced]
aggression = 0.4
risk_tolerance = 0.5
economic_focus = 0.7
expansion_drive = 0.5
diplomacy_value = 0.6
tech_priority = 0.5

[strategies_turtle]
aggression = 0.1
risk_tolerance = 0.3
economic_focus = 0.7
expansion_drive = 0.4
diplomacy_value = 0.7
tech_priority = 0.7

[strategies_expansionist]
aggression = 0.6
risk_tolerance = 0.7
economic_focus = 0.4
expansion_drive = 0.95
diplomacy_value = 0.3
tech_priority = 0.3

[strategies_tech_rush]
aggression = 0.2
risk_tolerance = 0.4
economic_focus = 0.8
expansion_drive = 0.4
diplomacy_value = 0.7
tech_priority = 0.95

[strategies_raider]
aggression = 0.85
risk_tolerance = 0.9
economic_focus = 0.4
expansion_drive = 0.6
diplomacy_value = 0.1
tech_priority = 0.5

[strategies_military_industrial]
aggression = 0.7
risk_tolerance = 0.5
economic_focus = 0.75
expansion_drive = 0.6
diplomacy_value = 0.3
tech_priority = 0.6

[strategies_opportunistic]
aggression = 0.5
risk_tolerance = 0.6
economic_focus = 0.6
expansion_drive = 0.6
diplomacy_value = 0.5
tech_priority = 0.5

[strategies_isolationist]
aggression = 0.15
risk_tolerance = 0.2
economic_focus = 0.85
expansion_drive = 0.3
diplomacy_value = 0.2
tech_priority = 0.75

# ==============================================================================
# BUDGET ALLOCATIONS BY GAME ACT
# ==============================================================================
# Budget percentages for each build objective across the 4-act game progression
# All percentages should sum to 1.0 per act
#
# Build objectives:
# - Expansion: Colony ships (ETACs), facilities (spaceports, shipyards)
# - Defense: Defensive fleets, starbases
# - Military: Combat ships (capital, escort)
# - Reconnaissance: Scouts for ELI mesh and espionage
# - Special_units: Transports, fighters, specialized ships
# - Technology: Research investment

[budget_act1_land_grab]
expansion = 0.45       # Maximum expansion during land grab
defense = 0.10         # Low priority - personality-driven (homeworld-only for most AIs)
military = 0.20        # Maintain for colony defense
reconnaissance = 0.10  # Reduced from 0.30 - any ship can explore in Act 1
special_units = 0.10   # Increased from 0.05 - more ETACs for expansion
technology = 0.05      # Add minimal tech investment

[budget_act2_rising_tensions]
expansion = 0.10       # Reduced from 0.15 - most colonies claimed in Act 1
defense = 0.15         # Unchanged - maintain colony defense
military = 0.25        # Reduced from 0.30 - shift budget to special units
reconnaissance = 0.15  # Reduced from 0.20 - scouts already built
special_units = 0.30   # CRITICAL FIX: Need 180PP for carrier+fighters (was 0.15)
technology = 0.05      # Unchanged - minimal investment

[budget_act3_total_war]
expansion = 0.10
defense = 0.15
military = 0.45
reconnaissance = 0.05
special_units = 0.15
technology = 0.10

[budget_act4_endgame]
expansion = 0.05
defense = 0.10
military = 0.55
reconnaissance = 0.05
special_units = 0.15
technology = 0.10

# ==============================================================================
# TACTICAL PARAMETERS
# ==============================================================================
# Operational limits for fleet movements and responses

[tactical]
response_radius_jumps = 3        # Maximum distance for fleet response to threats
max_invasion_eta_turns = 8       # Maximum ETA for invasion operations
max_response_eta_turns = 5       # Maximum ETA for defensive responses

# ==============================================================================
# STRATEGIC PARAMETERS
# ==============================================================================
# Combat engagement thresholds

[strategic]
attack_threshold = 0.6           # Minimum strength ratio to attack (balanced)
aggressive_attack_threshold = 0.4 # Minimum ratio for aggressive personalities
retreat_threshold = 0.3          # Strength ratio triggering retreat

# ==============================================================================
# ECONOMIC PARAMETERS
# ==============================================================================
# Terraforming costs by planet class transition (in PP)

[economic]
terraforming_costs_extreme_to_desolate = 60
terraforming_costs_desolate_to_hostile = 150
terraforming_costs_hostile_to_harsh = 350
terraforming_costs_harsh_to_benign = 850
terraforming_costs_benign_to_lush = 2100
terraforming_costs_lush_to_eden = 5100

# ==============================================================================
# ORDERS PARAMETERS
# ==============================================================================
# Order generation parameters and thresholds

[orders]
research_max_percent = 0.25      # Maximum research budget (% of treasury)
espionage_investment_percent = 0.03  # Espionage budget (% of original treasury)
scout_count_act1 = 3             # Reduced from 5 - minimal scouting in Act 1
scout_count_act2 = 8             # Increased from 7 - ELI mesh priority in Act 2
scout_count_act3_plus = 10       # Increased from 9 - full coverage in Act 3+

# ==============================================================================
# LOGISTICS PARAMETERS
# ==============================================================================
# Mothballing and fleet management thresholds

[logistics]
mothballing_treasury_threshold_pp = 900      # Treasury level triggering mothballing consideration
mothballing_maintenance_ratio_threshold = 0.10  # Maintenance/production ratio triggering mothballing
mothballing_min_fleet_count = 3              # Minimum fleets before considering mothballing

# ==============================================================================
# FLEET COMPOSITION BY DOCTRINE
# ==============================================================================
# Target fleet composition ratios for different combat doctrines

[fleet_composition_balanced]
capital_ratio = 0.40
escort_ratio = 0.40
specialist_ratio = 0.20

[fleet_composition_aggressive]
capital_ratio = 0.50
escort_ratio = 0.35
specialist_ratio = 0.15

[fleet_composition_defensive]
capital_ratio = 0.30
escort_ratio = 0.50
specialist_ratio = 0.20

# ==============================================================================
# THREAT ASSESSMENT
# ==============================================================================
# Thresholds for threat level classification

[threat_assessment]
critical_threshold = 0.8
high_threshold = 0.6
moderate_threshold = 0.4
low_threshold = 0.2

# ==============================================================================
# ADMIRAL CONFIGURATION
# ==============================================================================
# Strategic fleet rebalancing for act-specific objectives

[domestikos]
enabled = true                      # Enable domestikos module for colony defense distribution
split_threshold_act1 = 2            # Split fleets with 2+ ships in Act 1
merge_threshold_act2 = 3            # Merge when 3+ idle single-ship fleets
rendezvous_preference = "homeworld" # Where to merge fleets: homeworld, frontline, center

# ZeroTurnCommand Fleet Management (Immediate-execution fleet operations)
fleet_management_enabled = true     # Enable merge/detach/transfer using ZeroTurnCommand API
                                    # Act 1: Detach ships for exploration coverage
                                    # Act 2+: Merge fleets for combat power, detach scouts for recon
                                    # All Acts: Transfer ships to optimize fleet compositions

# Phase 3: Build Requirements System (Requirements-driven ship production)
build_requirements_enabled = true   # Enable requirements-driven build system (IMMEDIATE ROLLOUT)
defense_gap_detection_enabled = true
defense_gap_max_distance = 5        # Max jump distance to consider for defense
offensive_requirements_enabled = true
critical_priority_homeworld = true  # Always Critical priority for homeworld
high_priority_production_threshold = 50  # Industry threshold for High priority
threat_assessment_radius = 3        # Jumps to check for enemy fleets

# Strategic Triage Budget Reserves (Wise Admiral - maintain awareness)
min_recon_budget_percent = 0.10     # Minimum 10% for reconnaissance
min_expansion_budget_percent = 0.05 # Minimum 5% for expansion

# Escalation Thresholds (Engaging AI - responds to player actions)
escalation_low_to_medium_turns = 3  # Low → Medium after 3 turns undefended
escalation_medium_to_high_turns = 5 # Medium → High after 5 turns
escalation_high_to_critical_turns = 7  # High → Critical after 7 turns

# ==============================================================================
# EPARCH PARAMETERS (Economic Administration)
# ==============================================================================
# Colony management: auto-repair, tax rates, dock allocation

[eparch]
auto_repair_threshold = 100  # Min treasury (PP) to enable auto-repair at colonies
                             # Below this: disable auto-repair to conserve PP
                             # Above this: enable for convenience

# ==============================================================================
# INTELLIGENCE INTEGRATION (Phase B+)
# ==============================================================================
# Enhanced intelligence processing from engine intelligence reports
# Enables RBA to utilize ColonyIntelReport, SystemIntelReport, etc.

[intelligence]
# Report freshness thresholds (turns)
colony_intel_stale_threshold = 10      # Colony reports stale after 10 turns
system_intel_stale_threshold = 5       # Fleet movement stale after 5 turns
starbase_intel_stale_threshold = 15    # Economic/tech intel stale after 15 turns

# Threat assessment weights (must sum to 1.0)
threat_fleet_strength_weight = 0.4     # Fleet strength contribution to threat
threat_proximity_weight = 0.3          # Distance contribution to threat
threat_recent_activity_weight = 0.3    # Recent hostile actions contribution

# Threat distance thresholds (jumps)
threat_critical_distance = 1           # Enemy 1 jump away = Critical
threat_high_distance = 2               # Enemy 2 jumps away = High
threat_moderate_distance = 4           # Enemy 4 jumps away = Moderate

# Vulnerability assessment
vulnerability_defense_ratio_threshold = 0.3  # Defender/Attacker < 0.3 = vulnerable
vulnerability_value_threshold = 50           # Min production to be high-value target

# Combat learning (Phase C)
combat_report_learning_enabled = true   # Learn from combat encounters
combat_lesson_retention_turns = 50      # Remember lessons for 50 turns
combat_doctrine_detection_threshold = 3 # Detect doctrine after 3 battles

# Economic intelligence (Phase C)
economic_assessment_min_colonies = 2    # Need 2+ known colonies for assessment
economic_strength_production_weight = 0.6
economic_strength_income_weight = 0.4

# Research intelligence (Phase C)
tech_gap_critical_threshold = 3         # 3+ tech levels behind = critical gap
tech_gap_high_threshold = 2             # 2 tech levels behind = high priority

[drungarius]
# Intelligence coordinator settings
intel_processing_enabled = true         # Enable enhanced intelligence processing
use_combat_lessons = true              # Use CombatEncounterReport for learning (Phase C)
use_starbase_surveillance = true       # Use StarbaseSurveillanceReport (Phase D)
prioritize_high_value_targets = true   # Focus espionage on valuable targets
