# EC4X Rule-Based AI Configuration
# All RBA tuning parameters centralized for balance testing
#
# This configuration system enables:
# - Balance testing without recompilation
# - Genetic algorithm parameter evolution
# - A/B testing of different AI behaviors
# - Rapid iteration during AI development
#
# IMPORTANT: All field names use snake_case to match engine config convention
# TOML structure mirrors the Nim type definitions in src/ai/rba/config.nim

# ==============================================================================
# STRATEGY PERSONALITIES (12 strategies × 6 traits)
# ==============================================================================
# Each strategy defines a unique AI personality with weighted preferences
# Traits range from 0.0 (minimum) to 1.0 (maximum)

[strategies_aggressive]
aggression = 0.9
risk_tolerance = 0.8
economic_focus = 0.5
expansion_drive = 0.8
diplomacy_value = 0.2
tech_priority = 0.4

[strategies_economic]
aggression = 0.3
risk_tolerance = 0.3
economic_focus = 0.9
expansion_drive = 0.5
diplomacy_value = 0.6
tech_priority = 0.8

[strategies_espionage]
aggression = 0.5
risk_tolerance = 0.6
economic_focus = 0.5
expansion_drive = 0.65
diplomacy_value = 0.4
tech_priority = 0.6

[strategies_diplomatic]
aggression = 0.3
risk_tolerance = 0.4
economic_focus = 0.6
expansion_drive = 0.5
diplomacy_value = 0.9
tech_priority = 0.5

[strategies_balanced]
aggression = 0.4
risk_tolerance = 0.5
economic_focus = 0.7
expansion_drive = 0.5
diplomacy_value = 0.6
tech_priority = 0.5

[strategies_turtle]
aggression = 0.1
risk_tolerance = 0.3
economic_focus = 0.7
expansion_drive = 0.4
diplomacy_value = 0.7
tech_priority = 0.7

[strategies_expansionist]
aggression = 0.6
risk_tolerance = 0.7
economic_focus = 0.4
expansion_drive = 0.95
diplomacy_value = 0.3
tech_priority = 0.3

[strategies_tech_rush]
aggression = 0.2
risk_tolerance = 0.4
economic_focus = 0.8
expansion_drive = 0.4
diplomacy_value = 0.7
tech_priority = 0.95

[strategies_raider]
aggression = 0.85
risk_tolerance = 0.9
economic_focus = 0.4
expansion_drive = 0.6
diplomacy_value = 0.1
tech_priority = 0.5

[strategies_military_industrial]
aggression = 0.7
risk_tolerance = 0.5
economic_focus = 0.75
expansion_drive = 0.6
diplomacy_value = 0.3
tech_priority = 0.6

[strategies_opportunistic]
aggression = 0.5
risk_tolerance = 0.6
economic_focus = 0.6
expansion_drive = 0.6
diplomacy_value = 0.5
tech_priority = 0.5

[strategies_isolationist]
aggression = 0.15
risk_tolerance = 0.2
economic_focus = 0.85
expansion_drive = 0.3
diplomacy_value = 0.2
tech_priority = 0.75

# ==============================================================================
# BUDGET ALLOCATIONS BY GAME ACT
# ==============================================================================
# Budget percentages for each build objective across the 4-act game progression
# All percentages should sum to 1.0 per act
#
# Build objectives:
# - Expansion: Colony ships (ETACs), facilities (spaceports, shipyards)
# - Defense: Defensive fleets, starbases
# - Military: Combat ships (capital, escort)
# - Reconnaissance: Scouts for ELI mesh and espionage
# - Special_units: Transports, fighters, specialized ships
# - Technology: Research investment

[budget_act1_land_grab]
expansion = 0.55       # INCREASED: Maximum expansion during land grab
defense = 0.08         # REDUCED: Low priority - personality-driven (homeworld-only for most AIs)
military = 0.12        # REDUCED: Shift more budget to expansion
reconnaissance = 0.08  # REDUCED: Any ship can explore in Act 1
special_units = 0.12   # REDUCED: Need transports for invasion capability
technology = 0.05      # Minimal tech investment
filler_budget_reserved = 0.15  # 15% reserved for capacity utilization (separate from allocations)
# Total allocations: 0.55 + 0.08 + 0.12 + 0.08 + 0.12 + 0.05 = 1.00
# Filler budget is a separate reserve pool handled by splitting logic

[budget_act2_rising_tensions]
expansion = 0.45       # INCREASED from 0.20 - maintain colonization momentum through Act 2
defense = 0.10         # REDUCED from 0.15 - shift to expansion
military = 0.15        # Unchanged - balanced military buildup
reconnaissance = 0.10  # REDUCED from 0.15 - shift to expansion
special_units = 0.15   # REDUCED from 0.30 - shift to expansion
technology = 0.05      # Unchanged - minimal investment
filler_budget_reserved = 0.15  # 15% reserved for capacity utilization (Gap Fix)
    
[budget_act3_total_war]
expansion = 0.15       # INCREASED from 0.10 - continue facility scaling at mid-game colonies
defense = 0.10         # REDUCED from 0.15 - shift to expansion
military = 0.45        # Unchanged - war economy
reconnaissance = 0.05  # Unchanged - scouts already deployed
special_units = 0.15   # Unchanged - maintain carriers/fighters
technology = 0.10      # Unchanged - tech investment
filler_budget_reserved = 0.10  # Reduced to 10% for Act 3
    
[budget_act4_endgame]
expansion = 0.10       # INCREASED from 0.05 - finish facility scaling at late colonies
defense = 0.05         # REDUCED from 0.10 - shift to expansion
military = 0.55        # Unchanged - all-in on military
reconnaissance = 0.05  # Unchanged - recon complete
special_units = 0.15   # Unchanged - maintain specialized assets
technology = 0.10      # Unchanged - tech investment
filler_budget_reserved = 0.05  # Reduced to 5% for Act 4

# ==============================================================================
# TACTICAL PARAMETERS
# ==============================================================================
# Operational limits for fleet movements and responses

[tactical]
response_radius_jumps = 3        # Maximum distance for fleet response to threats
max_invasion_eta_turns = 8       # Maximum ETA for invasion operations
max_response_eta_turns = 5       # Maximum ETA for defensive responses
min_population_for_reload = 4    # Minimum colony PU for ETAC reload (must leave 1 PU after 3 PTU drain)

# ==============================================================================
# STRATEGIC PARAMETERS
# ==============================================================================
# Combat engagement thresholds

[strategic]
attack_threshold = 0.6           # Minimum strength ratio to attack (balanced)
aggressive_attack_threshold = 0.4 # Minimum ratio for aggressive personalities
retreat_threshold = 0.3          # Strength ratio triggering retreat

# ==============================================================================
# ECONOMIC PARAMETERS
# ==============================================================================
# Terraforming costs by planet class transition (in PP)

[economic]
terraforming_costs_extreme_to_desolate = 60
terraforming_costs_desolate_to_hostile = 150
terraforming_costs_hostile_to_harsh = 350
terraforming_costs_harsh_to_benign = 850
terraforming_costs_benign_to_lush = 2100
terraforming_costs_lush_to_eden = 5100

# ==============================================================================
# ORDERS PARAMETERS
# ==============================================================================
# Order generation parameters and thresholds

[orders]
research_max_percent = 0.25      # Maximum research budget (% of treasury)
espionage_investment_percent = 0.03  # Espionage budget (% of original treasury)
scout_count_act1 = 3             # Reduced from 5 - minimal scouting in Act 1
scout_count_act2 = 8             # Increased from 7 - ELI mesh priority in Act 2
scout_count_act3_plus = 10       # Increased from 9 - full coverage in Act 3+

# ==============================================================================
# LOGISTICS PARAMETERS
# ==============================================================================
# Mothballing and fleet management thresholds

[logistics]
mothballing_treasury_threshold_pp = 900      # Treasury level triggering mothballing consideration
mothballing_maintenance_ratio_threshold = 0.10  # Maintenance/production ratio triggering mothballing
mothballing_min_fleet_count = 3              # Minimum fleets before considering mothballing

# ==============================================================================
# FLEET COMPOSITION BY DOCTRINE
# ==============================================================================
# Target fleet composition ratios for different combat doctrines

[fleet_composition_balanced]
capital_ratio = 0.40
escort_ratio = 0.40
specialist_ratio = 0.20

[fleet_composition_aggressive]
capital_ratio = 0.50
escort_ratio = 0.35
specialist_ratio = 0.15

[fleet_composition_defensive]
capital_ratio = 0.30
escort_ratio = 0.50
specialist_ratio = 0.20

# ==============================================================================
# THREAT ASSESSMENT
# ==============================================================================
# Thresholds for threat level classification

[threat_assessment]
critical_threshold = 0.8
high_threshold = 0.6
moderate_threshold = 0.4
low_threshold = 0.2

# ==============================================================================
# ADMIRAL CONFIGURATION
# ==============================================================================
# Strategic fleet rebalancing for act-specific objectives

[domestikos]
enabled = true                      # Enable domestikos module for colony defense distribution
split_threshold_act1 = 2            # Split fleets with 2+ ships in Act 1
merge_threshold_act2 = 3            # Merge when 3+ idle single-ship fleets
rendezvous_preference = "homeworld" # Where to merge fleets: homeworld, frontline, center
max_invasion_eta_turns = 8          # Maximum ETA for invasion operations

# Affordability thresholds (how much of treasury per build request)
# These are per-request limits, not total spending caps
affordability_act1 = 0.30           # Act 1: 30% of treasury per request
affordability_act2 = 0.50           # Act 2: 50% of treasury per request
affordability_act3 = 0.70           # Act 3: 70% of treasury per request
affordability_act4 = 0.90           # Act 4: 90% of treasury per request

[domestikos.offensive]
# Offensive operations priority and scoring parameters
# Priority values for requirement types
priority_base = 80                  # Base priority for offensive operations
priority_high = 90                  # High priority (enemy targets)
priority_medium = 70                # Medium priority
priority_low = 50                   # Low priority
priority_deferred = 30              # Deferred priority

# Distance-based proximity bonuses (priority boost by jump distance)
distance_bonus_1_2_jumps = 300.0    # Immediate neighbors (1-2 jumps)
distance_bonus_3_4_jumps = 100.0    # Close targets (3-4 jumps)
distance_bonus_5_6_jumps = 50.0     # Moderate distance (5-6 jumps)

# Target weakness thresholds (strength ratio for vulnerable targets)
weakness_threshold_vulnerable = 0.7  # <70% of average = vulnerable
weakness_threshold_weak = 0.4        # <40% of average = very weak
weakness_priority_boost = 75.0       # Priority boost for weak targets

# Strength and value multipliers
fleet_strength_multiplier = 50.0     # Fleet strength contribution
estimated_value_multiplier = 2.0     # Estimated colony value multiplier
vulnerability_multiplier = 50.0      # Vulnerability score multiplier

# Defense estimation
ground_defense_divisor = 2           # Estimate ground defenses (div 2)

# Intelligence parameters
max_intel_age_turns = 5              # Max age for intel to be useful
conservative_ship_estimate = 5       # Ships to assume if no intel

# ROE (Rules of Engagement) priority
roe_blitz_priority = 9               # Blitz attack priority
roe_bombardment_priority = 8         # Bombardment priority

[domestikos.defensive]
# Defensive operations priority and scoring parameters
# Production-based scoring
production_weight = 0.5              # Colony production weight in priority

# Threat-based priority boosts
threat_boost_critical = 500.0        # Critical threat priority boost
threat_boost_high = 200.0            # High threat priority boost
threat_boost_moderate = 50.0         # Moderate threat priority boost

# Proximity-based multipliers (threat escalation by distance)
proximity_multiplier_1_jump = 3.0    # 1 jump away = imminent threat
proximity_multiplier_2_jumps = 2.0   # 2 jumps away = near threat
movement_boost_base = 50.0           # Base movement threat boost

# Intel quality penalties
stale_intel_penalty = 0.9            # 10% penalty for stale intel

# Strategic bonuses
frontier_bonus_per_distance = 2.0    # Frontier colony bonus per jump
owned_system_priority_boost = 75.0   # Boost for threatened owned systems

# Tactical parameters
defend_max_range = 3                 # Max jump range for defense orders

[domestikos.intelligence_ops]
# Intelligence operations scoring (threat assessment)
threat_contribution_per_fleet = 0.3  # Threat added per nearby enemy fleet
threat_level_high_score = 0.75       # High threat level score
threat_level_moderate_score = 0.5    # Moderate threat level score
threat_level_low_score = 0.25        # Low threat level score

[domestikos.staging]
# Staging location priority scoring
priority_acceptable_close = 50.0     # Acceptable location, close distance
priority_acceptable_far = 30.0       # Acceptable location, far distance
priority_owned_system = 200.0        # Strong preference for owned systems

# ZeroTurnCommand Fleet Management (Immediate-execution fleet operations)
fleet_management_enabled = true     # Enable merge/detach/transfer using ZeroTurnCommand API
                                    # Act 1: Detach ships for exploration coverage
                                    # Act 2+: Merge fleets for combat power, detach scouts for recon
                                    # All Acts: Transfer ships to optimize fleet compositions

# Phase 3: Build Requirements System (Requirements-driven ship production)
build_requirements_enabled = true   # Enable requirements-driven build system (IMMEDIATE ROLLOUT)
defense_gap_detection_enabled = true
defense_gap_max_distance = 5        # Max jump distance to consider for defense
offensive_requirements_enabled = true
critical_priority_homeworld = true  # Always Critical priority for homeworld
high_priority_production_threshold = 50  # Industry threshold for High priority
threat_assessment_radius = 3        # Jumps to check for enemy fleets

# Strategic Triage Budget Reserves (Wise Admiral - maintain awareness)
min_recon_budget_percent = 0.08     # REDUCED: Minimum 8% for reconnaissance (was 0.10)
min_expansion_budget_percent = 0.15 # INCREASED: Minimum 15% for expansion (was 0.05)

# Escalation Thresholds (Engaging AI - responds to player actions)
escalation_low_to_medium_turns = 3  # Low → Medium after 3 turns undefended
escalation_medium_to_high_turns = 5 # Medium → High after 5 turns
escalation_high_to_critical_turns = 7  # High → Critical after 7 turns

# Intelligence-Driven Ship Building (Phase F)
# Squadron capacity awareness and intelligence-driven requirements
capacity_high_utilization_threshold = 0.9  # Defer non-critical requirements at 90%+ capacity
scouts_per_stale_intel_system = 0.5        # 1 scout per 2 stale intel systems
scouts_per_enemy_house = 1.0               # 1 scout per enemy house for espionage
max_scouts_act1 = 3                        # Minimal scouts in Act 1 (any ship explores)
etacs_per_uncolonized_system = 2.0         # 2.0 ETACs per uncolonized system (aggressive colonization)
max_etacs_queued = 16                      # Cap ETAC production at 16 (higher buffer for large maps)

# Offensive building (personality-modulated)
aggressive_transport_ratio = 0.33          # Aggressive AI: 1 transport per 3 colonies
aggressive_marine_per_transport = 1        # 1 marine division per transport
reactive_invasion_multiplier = 1.5         # Defensive AI: 1.5x enemy defenses for invasion

# Phase 2: Invasion Campaign Management (Multi-turn invasion sequencing)
# Enables Bombardment → Invasion sequences across multiple turns
max_concurrent_campaigns = 3               # Maximum simultaneous invasion campaigns
campaign_stall_timeout = 3                 # Turns without action before abandoning campaign
campaign_bombardment_max = 10              # Max bombardment rounds before reassessment
campaign_intel_freshness = 5               # Max age (turns) for intel to be considered fresh

# Fighter/Carrier requirements (threat-based)
fighter_threat_threshold_low = 0.2         # Threat > 0.2 = threatened colony
fighter_threat_threshold_high = 0.5        # Threat > 0.5 = high-threat colony
max_fighters = 20                          # Cap total fighters at 20
fighters_per_carrier = 4                   # 1 carrier per 4 fighters
max_carriers = 6                           # Cap total carriers at 6

# ==============================================================================
# EPARCH PARAMETERS (Economic Administration)
# ==============================================================================
# Colony management: auto-repair, tax rates, dock allocation

[eparch]
auto_repair_threshold = 100  # Min treasury (PP) to enable auto-repair at colonies
                             # Below this: disable auto-repair to conserve PP
                             # Above this: enable for convenience

[eparch.maintenance]
# Maintenance shortfall penalty avoidance
penalty_turns_critical = 3   # Critical response threshold (turns)

[eparch.facilities]
# Threat penalty multipliers for facility placement (0.0-1.0)
# Applied to colony production score when selecting facility location
threat_penalty_critical_shipyard = 0.2    # Critical threat: 80% penalty
threat_penalty_high_shipyard = 0.5        # High threat: 50% penalty
threat_penalty_moderate_shipyard = 0.8    # Moderate threat: 20% penalty
threat_penalty_critical_spaceport = 0.2   # Critical threat: 80% penalty
threat_penalty_high_spaceport = 0.5       # High threat: 50% penalty
threat_penalty_moderate_spaceport = 0.8   # Moderate threat: 20% penalty
threat_penalty_critical_starbase = 0.1    # Critical threat: 90% penalty (expensive)
threat_penalty_high_starbase = 0.3        # High threat: 70% penalty
threat_penalty_moderate_starbase = 0.7    # Moderate threat: 30% penalty

# Staleness penalty for blind spots (stale intelligence)
staleness_penalty_facility = 0.9          # 10% penalty for unknown risk (shipyard/spaceport)
staleness_penalty_starbase = 0.85         # 15% penalty for expensive starbase

# Target facility ratios by Act (multipliers applied to colony count)
# Shipyard targets
shipyard_ratio_act1 = 0.5                 # 1 per 2 colonies (expansion-focused)
shipyard_ratio_act2 = 1.0                 # 1 per colony (military buildup)
shipyard_ratio_act3 = 1.5                 # 1.5 per colony (maximum production)
shipyard_ratio_act4 = 2.5                 # 2.5 per colony (endgame capacity)

# Starbase targets
starbase_ratio_act1 = 0.0                 # 0 starbases (low priority during expansion)
starbase_ratio_act2 = 0.5                 # 1 per 2 colonies (economic infrastructure)
starbase_ratio_act3 = 1.0                 # 1 per colony (economic + defensive)
starbase_ratio_act4 = 2.0                 # 2 per colony (full infrastructure)

[eparch.terraforming]
# Terraforming priority calculation parameters
priority_base = 0.7                       # Base priority (0.0-1.0)
priority_cost_divisor = 5000.0            # Cost divisor for scaling (0.7 + cost/divisor)
priority_critical_threshold = 0.75        # Threshold for Critical priority (vs High)

[eparch.economic_pressure]
# Competitive economic assessment thresholds
# Used to detect when AI is falling behind economically
production_ratio_moderate = 0.7           # <70% of average enemy = economic pressure
production_ratio_severe = 0.5             # <50% of average enemy = severe pressure
shipyard_advantage_threshold = 3          # Enemy has 3+ more shipyards

# Infrastructure priority boosts when under economic pressure
boost_moderate_pressure = 1.5             # 50% priority boost at moderate pressure
boost_severe_pressure = 2.0               # 100% priority boost at severe pressure
boost_shipyard_disadvantage = 1.3         # 30% boost for shipyard disadvantage

[eparch.reprioritization]
# Reprioritization logic parameters (extends global reprioritization config)
max_iterations = 3                        # Maximum reprioritization iterations
expensive_requirement_ratio = 0.3         # >30% of treasury = expensive

# ==============================================================================
# INTELLIGENCE INTEGRATION (Phase B+)
# ==============================================================================
# Enhanced intelligence processing from engine intelligence reports
# Enables RBA to utilize ColonyIntelReport, SystemIntelReport, etc.

[intelligence]
# Report freshness thresholds (turns)
colony_intel_stale_threshold = 10      # Colony reports stale after 10 turns
system_intel_stale_threshold = 5       # Fleet movement stale after 5 turns
starbase_intel_stale_threshold = 15    # Economic/tech intel stale after 15 turns

# Threat assessment weights (must sum to 1.0)
threat_fleet_strength_weight = 0.4     # Fleet strength contribution to threat
threat_proximity_weight = 0.3          # Distance contribution to threat
threat_recent_activity_weight = 0.3    # Recent hostile actions contribution

# Threat distance thresholds (jumps)
threat_critical_distance = 1           # Enemy 1 jump away = Critical
threat_high_distance = 2               # Enemy 2 jumps away = High
threat_moderate_distance = 4           # Enemy 4 jumps away = Moderate

# Vulnerability assessment
vulnerability_defense_ratio_threshold = 0.5  # Defender/Attacker < 0.5 = vulnerable
vulnerability_value_threshold = 30           # Min production to be invasion target

# Combat learning (Phase C)
combat_report_learning_enabled = true   # Learn from combat encounters
combat_lesson_retention_turns = 50      # Remember lessons for 50 turns
combat_doctrine_detection_threshold = 3 # Detect doctrine after 3 battles

# Economic intelligence (Phase C)
economic_assessment_min_colonies = 2    # Need 2+ known colonies for assessment
economic_strength_production_weight = 0.6
economic_strength_income_weight = 0.4

# Research intelligence (Phase C)
tech_gap_critical_threshold = 3         # 3+ tech levels behind = critical gap
tech_gap_high_threshold = 2             # 2 tech levels behind = high priority

[intelligence_threat_response]
# Threat-aware budget allocation (Phase D)
low_threat_boost = 0.10
moderate_threat_boost = 0.30
high_threat_boost = 0.50
critical_threat_boost = 1.00
multi_threat_multiplier = 1.5
defense_boost_ratio = 0.6
military_boost_ratio = 0.4

[intelligence_surveillance]
# Surveillance gap priority weights (Phase D)
border_system_priority = 0.9
high_value_priority = 0.8
transit_route_priority = 0.6
recent_activity_priority = 0.7

[intelligence_diplomatic_events]
# Diplomatic event analysis (Phase E)
war_significance_threshold = 8
alliance_significance_threshold = 7
blockade_critical_threshold = 0.4

[intelligence_counterintel]
# Counter-intelligence priorities (Phase E)
high_frequency_threshold = 3
detection_success_threshold = 0.6
priority_boost_espionage = 0.15

[intelligence_construction_analysis]
# Construction trend detection (Phase E)
buildup_threshold_shipyards = 2
velocity_threat_threshold = 1.5
observation_window_turns = 10

[intelligence_patrol_detection]
# Patrol pattern recognition (Phase E)
min_sightings_for_pattern = 3
pattern_confidence_threshold = 0.7
staleness_threshold_turns = 5

[drungarius]
# Intelligence coordinator settings
intel_processing_enabled = true         # Enable enhanced intelligence processing
use_combat_lessons = true              # Use CombatEncounterReport for learning (Phase C)
use_starbase_surveillance = true       # Use StarbaseSurveillanceReport (Phase D)
prioritize_high_value_targets = true   # Focus espionage on valuable targets

# Espionage budget allocation by Act (PP per turn)
espionage_budget_act1 = 5               # Act 1: Minimal espionage (expansion focus)
espionage_budget_act2 = 10              # Act 2: Moderate espionage (rising tensions)
espionage_budget_act3 = 10              # Act 3: Maintain intelligence during war
espionage_budget_act4 = 20              # Act 4: Maximum espionage (endgame intelligence)

# Research budget allocation by Act (PP per turn, for tech field analysis)
research_budget_act1 = 3                # Act 1: Minimal tech analysis
research_budget_act2 = 7                # Act 2: Moderate tech intelligence
research_budget_act3 = 10               # Act 3: Increased tech tracking
research_budget_act4 = 15               # Act 4: Maximum tech intelligence

# ==============================================================================
# BASILEUS CONFIGURATION (Decision Mediator)
# ==============================================================================
# Personality-driven advisor weight adjustments

[basileus]
# Personality influence multipliers (applied to base weight of 1.0)
# Formula: baseWeight = 1.0 ± (personalityTrait - 0.5) * multiplier
personality_domestikos_multiplier = 0.3     # Aggression influence on fleet advisor
personality_logothete_multiplier = 0.3      # Tech priority influence on research advisor
personality_drungarius_multiplier = 0.15    # Aggression influence on intelligence advisor
personality_protostrator_multiplier = 0.3   # Diplomacy value influence on strategic advisor
personality_eparch_multiplier = 0.3         # Economic focus influence on economic advisor

# Act-specific adjustments
act1_research_multiplier = 0.7              # Reduce research priority in Act 1 (expansion focus)
act2_war_research_multiplier = 0.85         # Reduce research during Act 2 wars
act2_hostile_research_multiplier = 0.9      # Reduce research with hostile neighbors in Act 2
act3_war_military_multiplier = 2.0          # Boost military in Act 3 war
act4_war_military_multiplier = 2.5          # Maximum military focus in Act 4 war
act3_war_research_multiplier = 0.7          # Reduce research during Act 3 war
act4_war_research_multiplier = 0.5          # Minimal research in Act 4 war (all-in military)
act3_war_diplomacy_multiplier = 0.60        # Reduce diplomacy during war (focus on combat)
act3_peace_diplomacy_multiplier = 0.75      # Moderate diplomacy in Act 3 peace
act4_peace_research_multiplier = 1.0        # Maintain tech in Act 4 peace
act3_peace_research_multiplier = 0.8        # Slight reduction in Act 3 peace

# ==============================================================================
# GAP FIXES (Phase 1-2)
# ==============================================================================
# Configuration for architectural improvements to RBA system

[feedback_system]
# Rich feedback generation (Gap 6)
enabled = true
suggest_cheaper_alternatives = true
min_partial_fulfillment_ratio = 0.25

[reprioritization]
# Enhanced reprioritization logic (Gap 4)
enable_quantity_adjustment = true
min_quantity_reduction = 1
enable_substitution = true
max_cost_reduction_factor = 0.6
facility_critical_to_high_turns = 10
facility_high_to_medium_turns = 20

[standing_orders_integration]
# Standing order integration (Gap 5)
generate_support_requirements = true
defense_gap_priority_boost = 1
filler_standing_order_bias = 0.3
track_colony_defense_history = true
max_history_entries = 50

# ==============================================================================
# EPARCH INDUSTRIAL INVESTMENT
# Source: Previously hardcoded in industrial_investment.nim
# ==============================================================================

[eparch_industrial]
# RESOLVED: Match economy.toml (100.0) - was 200.0
iu_growth_divisor = 100.0           # IU passive growth divisor
iu_payback_threshold_turns = 10     # Investment payback threshold
iu_affordability_multiplier = 3     # Treasury safety multiplier (cost * 3)
iu_investment_fraction = 0.25       # Invest 25% of IU deficit
iu_minimum_investment = 10          # Minimum 10 IU per investment

# ==============================================================================
# TREASURY THRESHOLDS
# Source: Previously hardcoded across RBA modules
# ==============================================================================

[treasury_thresholds]
terraform_minimum = 800             # Min treasury for terraforming decisions
terraform_buffer = 200              # Reserve buffer for terraforming
transfer_healthy = 500              # Healthy treasury for logistics transfers
salvage_critical = 100              # Critical threshold for salvage decisions
reactivation_healthy = 1000         # Healthy treasury for reactivation

# ==============================================================================
# AFFORDABILITY CHECKS
# Source: Previously hardcoded in build_requirements.nim
# ==============================================================================

[affordability_checks]
# Treasury multipliers for different build decisions
general_multiplier = 1.5            # General affordability check (1.5x cost)
shield_multiplier = 2.0             # Shield affordability check (2x cost)
critical_multiplier = 3.0           # Critical threshold check (3x cost)

# ==============================================================================
# PROTOSTRATOR CONFIGURATION (Strategic & Diplomatic Advisor)
# ==============================================================================
# Diplomatic assessment and recommendation thresholds

[protostrator]
# Infrastructure value scoring
infrastructure_value_per_point = 5  # Value per infrastructure point

# Combat analysis parameters
combat_freshness_turns = 5          # Recent combat = last 5 turns

# Opportunity scoring (0.0-1.0 scale)
opportunity_score_recent_combat = 0.2   # Enemy recently in combat
opportunity_score_at_war = 0.3          # Enemy at war with others
opportunity_score_tensions = 0.1        # Enemy has diplomatic tensions
opportunity_score_multiple_fronts = 0.2 # Enemy fighting on multiple fronts

# Risk assessment
baseline_risk = 0.3                 # 30% baseline diplomatic risk

# Urgency scoring (additive)
urgency_critical_threats = 3        # +3 for critical military threats
urgency_economic_pressure = 2       # +2 for economic disadvantage
urgency_diplomatic_isolation = 2    # +2 for diplomatic isolation
urgency_border_tension = 2          # +2 for border tensions
urgency_prestige_threat = 3         # +3 for prestige competition

# Diplomatic requirement thresholds by Act
threshold_multiplier_act1 = 3.0     # Act 1: High threshold (expansion focus)
threshold_multiplier_act2 = 3.0     # Act 2: High threshold (buildup)
threshold_multiplier_act3 = 2.5     # Act 3: Lower threshold (war diplomacy)
threshold_multiplier_act4 = 2.5     # Act 4: Lower threshold (endgame)

# Mutual enemies scoring
mutual_enemies_base_score = 2.0     # Base score for shared enemies

[protostrator.pact_assessment]
# Non-Aggression Pact recommendation scoring (0.0-1.0 scale)
shared_enemies_weight = 0.3         # Weight for shared enemy count
mutual_enemies_weight = 0.2         # Weight per mutual enemy
diplomacy_trait_weight = 0.4        # Weight for diplomacy personality value
trust_weight = 0.2                  # Weight for low violation risk
recommendation_threshold = 0.5      # Threshold to recommend pact (≥0.5)

[protostrator.stance_recommendations]
# Stance change recommendation thresholds
hostile_threshold = 0.5             # Recommend Hostile if score ≥0.5
enemy_threshold = 0.7               # Recommend Enemy (war) if score ≥0.7
escalate_threshold = 0.6            # Escalate stance if score ≥0.6
deescalate_threshold = 0.5          # De-escalate stance if score ≥0.5
normalize_threshold = 0.5           # Normalize relations if score ≥0.5

# Stance scoring weights (0.0-1.0 scale)
aggression_hostile_weight = 0.3     # Aggression → Hostile
aggression_enemy_weight = 0.5       # Aggression → Enemy (war)
opportunity_hostile_weight = 0.2    # Opportunity → Hostile
opportunity_enemy_weight = 0.3      # Opportunity → Enemy
diplomacy_deescalate_weight = 0.4   # Diplomacy → De-escalate
diplomacy_normalize_weight = 0.4    # Diplomacy → Normalize
peace_bias_weight = 0.5             # Peace bias → De-escalate

# ==============================================================================
# LOGOTHETE CONFIGURATION (Research & Technology Advisor)
# ==============================================================================
# Research budget allocation across tech fields

[logothete]
# Technology caps
max_science_level = 8               # Science Level caps at 8

# Fixed research costs (estimated PP per tech requirement)
cost_urgent_tech = 200              # Urgent tech research
cost_counter_tech = 250             # Counter-tech to close gaps
cost_field_research = 300           # General field research

[logothete.allocation]
# Research budget allocation ratios by situation
# Act 1-2: Expansion focus (unbalanced allocation)
act1_economic_ratio = 0.33          # 33% to Economic Level (EL)
act1_science_ratio = 0.25           # 25% to Science Level (SL)
act1_remainder_split = true         # Split remainder across CST/WEP/DEF

# Act 3: Balanced growth
act3_economic_ratio = 0.40          # 40% to EL
act3_science_ratio = 0.40           # 40% to SL

# War economy: Minimal research
war_economic_ratio = 0.20           # 20% to EL (reduced)
war_science_ratio = 0.20            # 20% to SL (reduced)

# Default allocation (fallback)
default_economic_ratio = 0.33       # 33% to EL
default_science_ratio = 0.33        # 33% to SL

[logothete.counter_tech]
# Counter-technology response parameters
enemy_advantage_critical = 3        # Enemy 3+ levels ahead = critical
enemy_advantage_high = 2            # Enemy 2+ levels ahead = high priority

# ==============================================================================
# GOAP STRATEGIC PLANNING
# ==============================================================================
# Goal-Oriented Action Planning for multi-turn strategic decision making
# Status: MVP integration (Fleet + Build domains only)

[goap]
enabled = true                          # Enabled for MVP integration testing
planning_depth = 5                      # Phase 3: Max turns to plan ahead (increased for multi-turn invasions)
confidence_threshold = 0.5              # Min confidence to execute plan
max_concurrent_plans = 5                # Phase 3: Limit active plans (increased from 3)
defense_priority = 0.8                  # Weight for defensive goals
offense_priority = 0.7                  # Phase 3: Weight for offensive goals (increased from 0.6)
log_plans = true                        # Debug logging (enable for MVP)
budget_guidance_boost_factor = 0.3      # GOAP budget estimates boost RBA requirements
replan_stalled_turns = 3                # Replan if no progress for 3 turns
replan_budget_shortfall_ratio = 0.8     # Replan if remaining cost > 80% of treasury
new_opportunity_scan_frequency = 3      # Phase 3: Check for new opportunities every 3 turns (reduced frequency)

# Phase 3: Invasion Planning Parameters
invasion_min_strength_ratio = 1.5       # Need 1.5x estimated enemy strength
invasion_max_distance = 8               # Max jumps to invasion target
invasion_bombardment_estimate = 3       # Estimated bombardment turns for moderate defenses
invasion_priority_boost = 0.2           # Priority boost for invasion goals

# Phase 3: Campaign Coordination
disable_rba_campaigns_with_goap = false # Set true to disable Phase 2 RBA campaigns when GOAP handles invasions

# ==============================================================================
# ACT TRANSITIONS
# ==============================================================================
# Configurable thresholds for game Act transitions
# Act 1 (Land Grab) continues until colonization threshold is met

[act_transitions]
act1_colonization_threshold = 0.90  # Act 1 ends when ≥90% of systems colonized
act2_colonization_threshold = 0.98  # Act 2 → Act 3 when ≥98% colonized
act2_max_turn = 22                  # Act 2 ends at turn 22 even if <98% colonized
act3_max_turn = 35                  # Act 3 ends at turn 35 (transition to Act 4)

# ==============================================================================
# ACT-SPECIFIC ADVISOR PRIORITIES
# ==============================================================================
# Maps the 4-Act Strategic Progression to advisor weight multipliers
# Based on docs/ai/architecture/ai_architecture.adoc lines 301-407
#
# These multipliers are applied to advisor requirements during Basileus mediation
# to reflect the strategic priorities of each game phase.
#
# Priority Mapping (Architecture → Config):
#   CRITICAL = 1.5x multiplier
#   HIGH     = 1.2x multiplier
#   MEDIUM   = 1.0x multiplier (baseline)
#   LOW      = 0.6x multiplier

[act_priorities.act1_land_grab]
# Act 1 Focus: Expansion & Reconnaissance
# Strategic Goal: Claim as much territory as possible before map fills
eparch_multiplier = 1.5           # CRITICAL - Drive aggressive colonization
domestikos_multiplier = 1.2       # HIGH - Build exploration ships, minimal combat
drungarius_multiplier = 1.0       # MEDIUM - Map nearby systems, find targets
logothete_multiplier = 1.0        # MEDIUM - CST for facilities, Propulsion for speed
protostrator_multiplier = 0.6     # LOW - Remain neutral, avoid early conflicts

[act_priorities.act2_rising_tensions]
# Act 2 Focus: Consolidation & Military Buildup
# Strategic Goal: Build defensive position and prepare for conflict
domestikos_multiplier = 1.5       # CRITICAL - Construct credible combat fleet
eparch_multiplier = 1.2           # HIGH - Build starbases, invest in industry
logothete_multiplier = 1.2        # HIGH - Military tech (Weapons, Shields, Armor)
drungarius_multiplier = 1.0       # MEDIUM - Shift to espionage, assess threats
protostrator_multiplier = 1.0     # MEDIUM - Form defensive pacts, create blocs

[act_priorities.act3_total_war]
# Act 3 Focus: Conquest
# Strategic Goal: Eliminate rivals through decisive military action
domestikos_multiplier = 1.5       # CRITICAL - Execute large-scale invasions
drungarius_multiplier = 1.2       # HIGH - Tactical intel, sabotage enemy production
protostrator_multiplier = 1.2     # HIGH - Manage war alliances, break coalitions
eparch_multiplier = 1.0           # MEDIUM - War economy, replace combat losses
logothete_multiplier = 1.0        # MEDIUM - Advanced combat tech for advantage

[act_priorities.act4_endgame]
# Act 4 Focus: Securing Victory
# Strategic Goal: Finish off remaining rivals or defend leading position
domestikos_multiplier = 1.5       # CRITICAL - Eliminate last rivals, defend lead
eparch_multiplier = 1.2           # HIGH - Maximize prestige generation
protostrator_multiplier = 1.2     # HIGH - Isolate leader or prevent coalition
logothete_multiplier = 1.0        # MEDIUM - Game-ending tech for prestige/power
drungarius_multiplier = 1.0       # MEDIUM - Counter last-ditch espionage

# ==============================================================================
# COLONIZATION PARAMETERS
# ==============================================================================
# Proximity-weighted colonization targeting for circular expansion patterns

[colonization]
proximity_max_distance = 3        # Max jumps for proximity bonus
proximity_bonus_per_jump = 25.0   # Bonus points per jump closer to owned colony
proximity_weight_act1 = 0.05      # REDUCED from 0.3 - maximum spread in Act 1-2 (frontier expansion)
proximity_weight_act4 = 0.9       # Proximity weight in Act 3-4 (high - consolidation)

