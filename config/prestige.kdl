// EC4X Prestige Configuration v0.2
// Source: docs/specs/10-reference.md Section 10.4, docs/specs/01-gameplay.md Section 1.1
// Defines prestige values, victory/defeat conditions, morale, and dynamic scaling.

// --- Victory & Defeat Conditions ---
victory {
    (docs)"docs/specs/01-gameplay.md#section-1-1"
    // Also see: docs/specs/01-gameplay.md#section-1-4-1
    startingPrestige 100
    defeatThreshold 0            // Below 0 for consecutive turns = collapse
    defeatConsecutiveTurns 3
}

// --- Dynamic Prestige Scaling ---
dynamicScaling {
    (docs)"docs/specs/10-reference.md#section-10-4"
    // Controls game pacing by scaling base prestige values based on map size.
    enabled #true
    baseMultiplier 5.0             // Baseline multiplier for small maps
    baselineTurns 30
    baselineSystemsPerPlayer 8
    turnScalingFactor 2.0
    minMultiplier 1.5
    maxMultiplier 8.0
}

// --- Morale System ---
// NOTE: Morale tiers are now calculated RELATIVE to the leading house's prestige
// See combat.kdl retreat.moraleRoeModifiers for percentage thresholds
// See combat.kdl moraleChecks for CER bonuses per tier
// This section kept for future use if needed
morale {
    (docs)"docs/specs/07-combat.md#section-7-2-3"
}

// ============================================================================
// BASE PRESTIGE VALUES
// These are the raw values before the dynamicScaling multiplier is applied.
// ============================================================================

prestigeEvents {
    (docs)"docs/specs/10-reference.md#section-10-4"
    // Espionage prestige effects also documented in docs/specs/09-intel-espionage.md

    // --- Non-Competitive (Absolute Gains) ---
    techAdvancement { value 2; type "Absolute" }
    colonyEstablishment { value 5; type "Absolute" }
    victoryAchieved { value 5; type "Absolute" }

    // --- Competitive (Zero-Sum) ---
    systemCapture { value 10; type "ZeroSum" }
    shipDestroyed { value 1; type "ZeroSum" } // Per major ship
    starbaseDestroyed { value 5; type "ZeroSum" }
    fleetVictory { value 3; type "ZeroSum" } // Per battle
    planetConquered { value 10; type "ZeroSum" }
    houseEliminated { value 3; type "ZeroSum" }

    // --- Espionage (Non-Zero-Sum Competitive) ---
    techTheft { value 20; victimLoss -30 }
    sabotageLowImpact { value 10; victimLoss -10 }
    sabotageHighImpact { value 30; victimLoss -50 }
    assassination { value 50; victimLoss -70 }
    cyberAttack { value 20; victimLoss -30 }
    economicManipulation { value 30; victimLoss -7 }
    psyopsCampaign { value 10; victimLoss -3 }
    counterIntelligenceSweep { value 5; victimLoss 0 }
    intelligenceTheft { value 40; victimLoss -20 }
    plantDisinformation { value 15; victimLoss -15 }

    // --- Penalties ---
    espionageFailure { value -2; type "Penalty" }
    planetLost { value -10; type "Penalty" } // Base loss, defender side of planetConquered
    undefendedColonyMultiplier 1.5 // planetLost * 1.5, breaks zero-sum
}



// --- Tax Penalties (Single-turn exponential) ---
taxPenalty {
    (docs)"docs/specs/03-economy.md#section-3-2-1"
    // Exponential penalty for high tax rates (single turn, no history)
    // Formula: penalty = -floor(baseCoefficient × (taxRate - threshold)²)
    // Example curve (threshold=50, baseCoefficient=0.01, exponent=2):
    //   60% → -1, 70% → -4, 80% → -9, 90% → -16, 100% → -25
    threshold 50             // Tax rate below this incurs no penalty
    baseCoefficient 0.01     // Scaling factor for penalty curve
    exponent 2.0             // Exponential growth rate (2 = quadratic)
}

// --- Low-Tax Incentives ---
taxIncentives {
    (docs)"docs/specs/03-economy.md#section-3-2-2"
    // Note: Population growth multipliers are in economy.kdl
    tier 1 { minRate 21; maxRate 30; prestigeBonusPerColony 1 }
    tier 2 { minRate 11; maxRate 20; prestigeBonusPerColony 2 }
    tier 3 { minRate 0; maxRate 10; prestigeBonusPerColony 3 }
}

// --- Maintenance Shortfall Penalties ---
maintenanceShortfall {
    (docs)"docs/specs/03-economy.md#section-3-9-1"
    basePenalty -5           // Turn 1 prestige penalty
    escalationPerTurn -2     // Additional penalty per consecutive turn
    // Turn 1: -5, Turn 2: -7, Turn 3: -9, Turn 4: -11, etc.
}